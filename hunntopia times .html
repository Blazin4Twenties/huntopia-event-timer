<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Huntopia iOS Event Dashboard</title>
<style>
@keyframes gradientShift {
  0% {background-position: 0% 50%;}
  50% {background-position: 100% 50%;}
  100% {background-position: 0% 50%;}
}

body {
  font-family:'Segoe UI',sans-serif;
  margin:0;
  padding:20px;
  color:#eee;
  background:linear-gradient(120deg,#001046,#1a0080,#33005a,#001a88,#3000a0);
  background-size:400% 400%;
  animation:gradientShift 20s ease-in-out infinite;
  min-height:100vh;
  position:relative;
  overflow-x:hidden;
}

/* glowing motion overlay */
body::before {
  content:"";
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  background:
    radial-gradient(circle at 25% 30%,rgba(0,130,255,0.35) 0%,transparent 60%),
    radial-gradient(circle at 80% 70%,rgba(200,0,255,0.35) 0%,transparent 60%);
  background-blend-mode:screen;
  mix-blend-mode:lighten;
  pointer-events:none;
  animation:gradientShift 30s ease-in-out infinite;
  z-index:-1;
}

header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
  gap:10px;
  flex-wrap:wrap;
}

h1 {
  color:#00eaff;
  text-shadow:0 0 20px #00bfff,0 0 40px #0070ff;
  margin:0;
}

#clock {
  font-size:1.1em;
  color:#00ff95;
  text-shadow:0 0 8px #00ff95;
}

select, input[type="checkbox"] {
  background:#0b1422;
  color:#00e6ff;
  border:1px solid #00e6ff;
  border-radius:6px;
  padding:5px 10px;
}

label {color:#00e6ff;}

h2 {
  color:#ffcc00;
  text-shadow:0 0 8px #ffcc00;
  border-bottom:2px solid #444;
  margin-top:25px;
  padding-bottom:5px;
}

table {
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
  background:rgba(15,15,30,0.85);
  border-radius:10px;
  backdrop-filter:blur(8px);
  box-shadow:0 0 25px rgba(0,0,0,0.5);
  overflow:hidden;
}

th,td {padding:10px;text-align:left;vertical-align:top;}

tr.active {
  background:rgba(0,255,100,0.18);
  box-shadow:0 0 14px rgba(0,255,100,0.4);
}

tr.inactive {background:rgba(60,60,90,0.28);}

.active-name {color:#00ff7f;font-weight:bold;}
.inactive-name {color:#ff4d4d;font-weight:bold;}
.desc {font-size:0.9em;color:#aaa;line-height:1.3;}
.times-list {margin-top:6px;}
.badge {
  display:inline-block;
  margin-right:6px;
  margin-top:4px;
  padding:2px 6px;
  border:1px solid #444;
  border-radius:6px;
  font-size:12px;
  color:#ccc;
  background:rgba(25,25,40,0.9);
  box-shadow:0 0 6px rgba(0,0,0,0.6);
}
.countdown {font-weight:bold;color:#00ff95;}
.row-compact td {padding:8px 10px;}
</style>
</head>
<body>

<header>
  <h1>Huntopia iOS Event Dashboard</h1>
  <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
    <label for="timezoneSelect">Server:</label>
    <select id="timezoneSelect">
      <option value="0">Default (UTC)</option>
      <option value="8">Asia Server (UTC+8)</option>
      <option value="2">Europe Server (UTC+2)</option>
    </select>
    <label><input type="checkbox" id="activeOnly"> Show Active Only</label>
    <div id="clock"></div>
  </div>
</header>

<section id="Guild"><h2>Guild Events</h2><table><tbody></tbody></table></section>
<section id="Team"><h2>Team Events</h2><table><tbody></tbody></table></section>
<section id="Solo"><h2>Solo Events</h2><table><tbody></tbody></table></section>
<section id="Public"><h2>Public Events</h2><table><tbody></tbody></table></section>

<script>
const eventData={
 Guild:[
  {name:"Divine Duel",desc:"Monday, Wednesday, Friday, Sunday",times:[["21:00","21:30"]]},
  {name:"Elemental War",desc:"Tuesday, Thursday, Saturday",times:[["20:00","20:15"]]},
  {name:"Chaos Brawl",desc:"Monday, Wednesday, Friday, Sunday",times:[["20:00","20:30"]]},
  {name:"Cloud Wars",desc:"Available daily",times:[["00:30","02:00"],["12:30","14:00"],["19:30","21:00"],["21:30","23:00"]]},
  {name:"Cloud Wars Reset",desc:"Resets every Thursday 00:00 UTC",times:[],reset:true},
  {name:"Guild Boss",desc:"Daily",times:[["20:30","21:00"]]},
  {name:"Port Expedition (Port Battles)",desc:"Sunday 20:00–20:15 UTC",times:[["20:00","20:15"]]},
  {name:"Isle Expedition (Island Battles)",desc:"Sunday 20:20–21:00 UTC",times:[["20:20","21:00"]]},
  {name:"Bidding",desc:"Sunday 08:00–19:30 UTC",times:[["08:00","19:30"]]},
  {name:"Isle Expedition Rewards",desc:"Rewards distribution. Static event.",times:[],reset:true}
 ],
 Team:[
  {name:"Elements",desc:"Cycle: Weeks 2,4,6. Monday–Sunday",times:[["20:00","20:15"]]},
  {name:"Dark Hunt",desc:"Cycle: Weeks 2,4,6. Monday–Sunday",times:[["21:00","21:30"]]}
 ],
 Solo:[
  {name:"Max Combo",desc:"Cycle: Weeks 1,3,5. Monday–Sunday",times:[["21:00","21:20"]]},
  {name:"Lost Realm",desc:"Cycle: Weeks 1,3,5. Monday–Sunday",times:[["20:45","21:25"]]},
  {name:"Brawl",desc:"Cycle: Weeks 1,3,5. Sunday",times:[["20:00","20:30"]]},
  {name:"Duel",desc:"Cycle: Weeks 1,3,5. Sunday",times:[["21:00","21:30"]]}
 ],
 Public:[
  {name:"Q&A Fun",desc:"Cycle: Weeks 1,3,5. Sunday",times:[["12:00","12:10"]]},
  {name:"Cooking",desc:"Cycle: Weeks 1,3,5. Sunday",times:[["21:00","21:20"]]},
  {name:"Fishing",desc:"Daily",times:[["16:30","17:00"]]}
 ]
};

let tzOffset = 0;
let activeOnly = false;

function updateClock(){
  const utcNow = new Date();
  const serverNow = new Date(utcNow.getTime() + tzOffset * 3600 * 1000);
  const fmt = {hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false};
  document.getElementById("clock").textContent =
    serverNow.toLocaleTimeString('en-GB', fmt) + ` (UTC${tzOffset>=0?`+${tzOffset}`:tzOffset})`;
  return serverNow;
}

function formatCountdown(ms){
  if(ms<=0)return"0m 0s left";
  const totalSec=Math.floor(ms/1000);
  const m=Math.floor(totalSec/60);
  const s=totalSec%60;
  return`${m}m ${s}s left`;
}

function shiftTime(utcStr){
  const [h,m]=utcStr.split(":").map(Number);
  let newH=h+tzOffset;
  if(newH>=24)newH-=24;
  if(newH<0)newH+=24;
  return `${String(newH).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
}

function isActive(serverTime, startStr, endStr){
  const [sh,sm]=startStr.split(":").map(Number);
  const [eh,em]=endStr.split(":").map(Number);
  const start=new Date(serverTime);start.setHours(sh,sm,0,0);
  const end=new Date(serverTime);end.setHours(eh,em,0,0);
  return serverTime>=start && serverTime<end;
}

function renderSection(id,list,serverTime){
  const tbody=document.querySelector(`#${id} tbody`);
  tbody.innerHTML="";
  list.forEach(ev=>{
    if(ev.reset){
      const tr=document.createElement("tr");
      tr.className="row-compact";
      tr.innerHTML=`<td>${ev.name}</td><td>${ev.desc}</td><td></td>`;
      tbody.appendChild(tr);
      return;
    }

    let active=false, activeSlot=null, left=0;
    for(const [s,e] of ev.times){
      const localS=shiftTime(s);
      const localE=shiftTime(e);
      if(isActive(serverTime,localS,localE)){
        active=true;
        activeSlot=[localS,localE];
        const [eh,em]=localE.split(":").map(Number);
        const end=new Date(serverTime);
        end.setHours(eh,em,0,0);
        left=end-serverTime;
        break;
      }
    }

    if(activeOnly && !active) return;

    const tr=document.createElement("tr");
    tr.className=active?'active row-compact':'inactive row-compact';
    const name=document.createElement("td");
    const slotsHTML=ev.times.map(([s,e])=>{
      const localStart=shiftTime(s);
      const localEnd=shiftTime(e);
      return `<span class="badge">${localStart}–${localEnd}</span>`;
    }).join('');
    name.innerHTML=`
      ${ev.name} ${active?'<span class="active-name">(Active)</span>':'<span class="inactive-name">(Inactive)</span>'}
      <div class="desc">${ev.desc}</div>
      <div class="times-list">${slotsHTML}</div>`;

    const mid=document.createElement("td");
    mid.textContent=active?`${activeSlot[0]}–${activeSlot[1]}`:"";

    const cd=document.createElement("td");
    cd.className='countdown';
    cd.textContent=active?formatCountdown(left):"";

    tr.appendChild(name);tr.appendChild(mid);tr.appendChild(cd);
    tbody.appendChild(tr);
  });
}

function renderAll(){
  const serverNow=updateClock();
  renderSection("Guild",eventData.Guild,serverNow);
  renderSection("Team",eventData.Team,serverNow);
  renderSection("Solo",eventData.Solo,serverNow);
  renderSection("Public",eventData.Public,serverNow);
}

setInterval(renderAll,1000);
renderAll();

document.getElementById("timezoneSelect").addEventListener("change",e=>{
  tzOffset=parseInt(e.target.value);
  renderAll();
});

document.getElementById("activeOnly").addEventListener("change",e=>{
  activeOnly=e.target.checked;
  renderAll();
});
</script>
</body>
</html>
